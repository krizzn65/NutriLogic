import{u as w,r as o,b as h,R as e,a2 as N,a as _,t as v}from"./app-SHYzUhK3.js";import{C as F}from"./credit-card-1-BPTflZCH.js";function C(){const m=w(),[d,c]=o.useState(!1),[p,u]=o.useState(null),[t,f]=o.useState({full_name:"",nik:"",birth_date:"",gender:"",posyandu_id:"",birth_weight_kg:"",birth_height_cm:"",notes:""}),[l,g]=o.useState({});o.useEffect(()=>{k()},[]);const k=async()=>{try{const a=await h.get("/me"),r=a.data.data||a.data;r.posyandu_id&&f(n=>({...n,posyandu_id:r.posyandu_id}))}catch(a){console.error("Failed to fetch user data:",a)}},s=a=>{const{name:r,value:n}=a.target;f(i=>({...i,[r]:n})),l[r]&&g(i=>({...i,[r]:null}))},x=()=>{const a={},r=t.full_name.trim();if(r?r.length<2&&(a.full_name="Nama minimal 2 karakter"):a.full_name="Nama lengkap wajib diisi",t.nik){const n=t.nik.trim();/^\d{16}$/.test(n)||(a.nik="NIK harus 16 digit angka")}if(!t.birth_date)a.birth_date="Tanggal lahir wajib diisi";else{const n=new Date(t.birth_date),i=new Date,b=new Date;b.setFullYear(b.getFullYear()-18),n>i?a.birth_date="Tanggal lahir tidak boleh di masa depan":n<b&&(a.birth_date="Usia anak melebihi batas maksimal (18 tahun)")}return t.gender||(a.gender="Jenis kelamin wajib dipilih"),t.birth_weight_kg&&(parseFloat(t.birth_weight_kg)<0||parseFloat(t.birth_weight_kg)>10)&&(a.birth_weight_kg="Berat lahir harus antara 0-10 kg"),t.birth_height_cm&&(parseFloat(t.birth_height_cm)<0||parseFloat(t.birth_height_cm)>100)&&(a.birth_height_cm="Tinggi lahir harus antara 0-100 cm"),g(a),Object.keys(a).length===0},E=async a=>{if(a.preventDefault(),!!x()){c(!0),u(null);try{const r=await h.get("/me"),n=r.data.data||r.data;if(!n.posyandu_id){u("Akun Anda belum terdaftar di posyandu. Silakan hubungi admin."),c(!1);return}const i={...t,full_name:t.full_name.trim(),nik:t.nik?t.nik.trim():null,parent_id:n.id,posyandu_id:parseInt(n.posyandu_id),birth_weight_kg:t.birth_weight_kg?parseFloat(t.birth_weight_kg):null,birth_height_cm:t.birth_height_cm?parseFloat(t.birth_height_cm):null,notes:t.notes?t.notes.trim():null};await h.post("/children",i),m("/dashboard/anak",{state:{message:"Data anak berhasil ditambahkan!"}})}catch(r){console.error("Submit error:",r),r.response?.data?.errors?g(r.response.data.errors):u(r.response?.data?.message||"Gagal menambahkan data anak. Silakan coba lagi.")}finally{c(!1)}}},y=a=>{if(!a)return"00/00";const r=new Date(a),n=String(r.getMonth()+1).padStart(2,"0"),i=String(r.getFullYear()).slice(-2);return`${n}/${i}`};return e.createElement("div",{className:"flex flex-1 w-full h-full overflow-auto bg-gray-50"},e.createElement("div",{className:"p-4 md:p-8 w-full max-w-5xl mx-auto flex flex-col gap-8"},e.createElement(N,{title:"Tambah Anak",subtitle:"Portal Orang Tua"},e.createElement("button",{onClick:()=>m("/dashboard/anak"),className:"p-2 hover:bg-gray-200 rounded-lg transition-colors"},e.createElement("svg",{className:"w-6 h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})))),e.createElement("div",{className:"flex flex-col gap-8 items-center"},e.createElement("div",{className:"w-full max-w-md flex flex-col items-center"},e.createElement("div",{className:"w-full aspect-[1.586/1]"},e.createElement(F,{cardNumber:t.nik?t.nik.replace(/(\d{4})(?=\d)/g,"$1 "):"0000 0000 0000 0000",cardHolder:t.full_name||"NAMA ANAK",expiryDate:y(t.birth_date),cvv:t.gender==="L"?"001":t.gender==="P"?"002":"XXX",variant:"gradient",labelName:"NAMA ANAK",labelExpiry:"TGL LAHIR",brandLogo:v,chipImage:t.gender==="L"?_.kepala_bayi:t.gender==="P"?_.kepala_bayi_cewe:null}))),e.createElement("div",{className:"w-full max-w-3xl"},p&&e.createElement("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg mb-6"},e.createElement("div",{className:"flex items-center gap-2"},e.createElement("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},e.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})),e.createElement("span",null,p))),e.createElement("form",{onSubmit:E,className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6 md:p-8"},e.createElement("h3",{className:"text-lg font-semibold text-gray-800 mb-6"},"Informasi Anak"),e.createElement("div",{className:"space-y-5"},e.createElement("div",null,e.createElement("label",{htmlFor:"full_name",className:"block text-sm font-medium text-gray-700 mb-2"},"Nama Lengkap ",e.createElement("span",{className:"text-red-500"},"*")),e.createElement("input",{type:"text",id:"full_name",name:"full_name",value:t.full_name,onChange:s,className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all ${l.full_name?"border-red-500":"border-gray-200"}`,placeholder:"Masukkan nama lengkap anak"}),l.full_name&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},l.full_name)),e.createElement("div",null,e.createElement("label",{htmlFor:"nik",className:"block text-sm font-medium text-gray-700 mb-2"},"NIK (Opsional)"),e.createElement("input",{type:"text",id:"nik",name:"nik",value:t.nik,onChange:s,maxLength:"16",pattern:"[0-9]*",inputMode:"numeric",className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all ${l.nik?"border-red-500":"border-gray-200"}`,placeholder:"Masukkan 16 digit NIK"}),l.nik&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},l.nik)),e.createElement("div",{className:"grid grid-cols-2 gap-5"},e.createElement("div",null,e.createElement("label",{htmlFor:"birth_date",className:"block text-sm font-medium text-gray-700 mb-2"},"Tanggal Lahir ",e.createElement("span",{className:"text-red-500"},"*")),e.createElement("input",{type:"date",id:"birth_date",name:"birth_date",value:t.birth_date,onChange:s,max:new Date().toISOString().split("T")[0],min:new Date(new Date().setFullYear(new Date().getFullYear()-18)).toISOString().split("T")[0],className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all ${l.birth_date?"border-red-500":"border-gray-200"}`}),l.birth_date&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},l.birth_date)),e.createElement("div",null,e.createElement("label",{htmlFor:"gender",className:"block text-sm font-medium text-gray-700 mb-2"},"Jenis Kelamin ",e.createElement("span",{className:"text-red-500"},"*")),e.createElement("select",{id:"gender",name:"gender",value:t.gender,onChange:s,className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all ${l.gender?"border-red-500":"border-gray-200"}`},e.createElement("option",{value:""},"Pilih..."),e.createElement("option",{value:"L"},"Laki-laki"),e.createElement("option",{value:"P"},"Perempuan")),l.gender&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},l.gender))),e.createElement("div",{className:"grid grid-cols-2 gap-5"},e.createElement("div",null,e.createElement("label",{htmlFor:"birth_weight_kg",className:"block text-sm font-medium text-gray-700 mb-2"},"Berat Lahir (kg)"),e.createElement("input",{type:"number",id:"birth_weight_kg",name:"birth_weight_kg",value:t.birth_weight_kg,onChange:s,step:"0.1",min:"0",max:"10",className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all ${l.birth_weight_kg?"border-red-500":"border-gray-200"}`,placeholder:"0.0"}),l.birth_weight_kg&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},l.birth_weight_kg)),e.createElement("div",null,e.createElement("label",{htmlFor:"birth_height_cm",className:"block text-sm font-medium text-gray-700 mb-2"},"Tinggi Lahir (cm)"),e.createElement("input",{type:"number",id:"birth_height_cm",name:"birth_height_cm",value:t.birth_height_cm,onChange:s,step:"0.1",min:"0",max:"100",className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all ${l.birth_height_cm?"border-red-500":"border-gray-200"}`,placeholder:"0.0"}),l.birth_height_cm&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},l.birth_height_cm))),e.createElement("div",null,e.createElement("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 mb-2"},"Catatan (Opsional)"),e.createElement("textarea",{id:"notes",name:"notes",value:t.notes,onChange:s,rows:"3",className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all",placeholder:"Tambahkan catatan khusus mengenai kondisi anak..."}))),e.createElement("div",{className:"flex justify-end gap-3 mt-8 pt-6 border-t border-gray-100"},e.createElement("button",{type:"button",onClick:()=>m("/dashboard/anak"),className:"px-6 py-2.5 border border-gray-200 text-gray-600 font-medium rounded-xl hover:bg-gray-50 transition-colors",disabled:d},"Batal"),e.createElement("button",{type:"submit",disabled:d,className:"px-6 py-2.5 bg-blue-600 text-white font-medium rounded-xl hover:bg-blue-700 transition-colors disabled:bg-blue-400 disabled:cursor-not-allowed flex items-center gap-2 shadow-lg shadow-blue-600/20"},d?e.createElement(e.Fragment,null,e.createElement("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Menyimpan..."):e.createElement(e.Fragment,null,e.createElement("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})),"Simpan Data"))))))))}export{C as default};
