import{M as q,u as X,p as Y,r as s,b as j,R as e,V,af as re,aa as H,ag as ie,A as I,m as h,ad as J,ah as ce,ai as oe,Y as me,X as de,aj as ue,ak as Z,y as fe,al as pe,P as he,a9 as Q,a8 as be,am as xe}from"./app-2DBIoE10.js";function ge({selectedId:f,onBack:L,onDeleteSuccess:C,className:O=""}){const{id:K}=q(),o=f||K,N=X(),{invalidateCache:p}=Y(),[B,U]=s.useState(!0),[M,b]=s.useState(null),[i,z]=s.useState(null),[u,E]=s.useState(""),[$,x]=s.useState(!1),[R,_]=s.useState(!1),[w,S]=s.useState(!1),[T,D]=s.useState(!1),[A,y]=s.useState(!1),[t,r]=s.useState(null),[c,m]=s.useState(null),v=s.useRef(null),k=s.useRef(null),g=s.useRef(null),P=s.useRef(null);s.useEffect(()=>{o&&F(o)},[o]),s.useEffect(()=>{if(!o)return;const a=setInterval(()=>{document.visibilityState==="visible"&&F(o,!0)},3e4);return()=>clearInterval(a)},[o]),s.useEffect(()=>{ae()},[i?.messages]),s.useEffect(()=>{function a(l){k.current&&!k.current.contains(l.target)&&_(!1),g.current&&!g.current.contains(l.target)&&y(!1)}return document.addEventListener("mousedown",a),()=>{document.removeEventListener("mousedown",a)}},[]);const ee=a=>{const l=a.target.files[0];if(l){if(l.size>5*1024*1024){alert("Ukuran file maksimal 5MB");return}r(l),m(URL.createObjectURL(l)),y(!1)}},G=()=>{r(null),c&&(URL.revokeObjectURL(c),m(null)),P.current&&(P.current.value="")},te=async()=>{y(!1);try{const l=(await j.get(`/parent/consultations/${o}/child-data`)).data.data,n=`Data Kesehatan Anak:
Nama: ${l.name}
Usia: ${fe(l.age_months)}
BB: ${l.weight?l.weight+" kg":"-"}
TB: ${l.height?l.height+" cm":"-"}
LK: ${l.head_circumference?l.head_circumference+" cm":"-"}
Catatan: ${l.notes||"-"}`;E(d=>d?d+`

`+n:n)}catch(a){console.error("Failed to fetch child data:",a),alert("Gagal mengambil data anak.")}},ae=()=>{v.current?.scrollIntoView({behavior:"smooth"})},F=async(a,l=!1)=>{try{l||U(!0),b(null);const n=await j.get(`/parent/consultations/${a}`);z(n.data.data)}catch(n){if(n.response?.status===403)b("Anda tidak memiliki akses untuk melihat konsultasi ini.");else if(n.response?.status===404)b("Konsultasi tidak ditemukan.");else{const d=n.response?.data?.message||"Gagal memuat data konsultasi. Silakan coba lagi.";b(d)}console.error("Consultation fetch error:",n)}finally{l||U(!1)}},W=async a=>{if(a.preventDefault(),!(!u.trim()&&!t))try{x(!0),b(null);const l=new FormData;l.append("message",u.trim()||" "),t&&l.append("attachment",t);const n=await j.post(`/parent/consultations/${o}/messages`,l,{headers:{"Content-Type":"multipart/form-data"}});z(d=>({...d,messages:[...d.messages,n.data.data]})),E(""),G()}catch(l){const n=l.response?.data?.message||"Gagal mengirim pesan. Silakan coba lagi.";b(n),console.error("Send message error:",l)}finally{x(!1)}},le=()=>{_(!1),D(!0)},se=async()=>{try{S(!0),await j.delete(`/parent/consultations/${o}`),p("consultations_all"),p("consultations_open"),p("consultations_closed"),C?C():N("/dashboard/konsultasi")}catch(a){console.error("Delete error:",a),alert("Gagal menghapus percakapan. Silakan coba lagi."),S(!1),D(!1)}};if(B)return e.createElement("div",{className:"flex flex-1 w-full h-full items-center justify-center bg-slate-50"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.createElement("p",{className:"text-slate-500 font-medium"},"Memuat percakapan...")));if(M&&!i)return e.createElement("div",{className:"flex flex-1 w-full h-full items-center justify-center bg-slate-50"},e.createElement("div",{className:"text-center p-8 bg-white rounded-2xl shadow-lg max-w-md mx-4"},e.createElement("div",{className:"bg-red-100 p-4 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4"},e.createElement(V,{className:"w-8 h-8 text-red-600"})),e.createElement("h3",{className:"text-xl font-bold text-slate-800 mb-2"},"Terjadi Kesalahan"),e.createElement("p",{className:"text-slate-600 mb-6"},M),e.createElement("div",{className:"flex gap-3 justify-center"},e.createElement("button",{onClick:()=>N("/dashboard/konsultasi"),className:"px-6 py-2.5 bg-slate-200 text-slate-700 rounded-xl hover:bg-slate-300 transition-colors font-medium"},"Kembali"),e.createElement("button",{onClick:()=>F(o),className:"px-6 py-2.5 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors font-medium"},"Coba Lagi"))));if(!i)return null;const ne=a=>a.sender_role==="ibu";return e.createElement("div",{className:`flex flex-col h-full bg-slate-50 relative overflow-hidden ${O}`},e.createElement("div",{className:"bg-white/80 backdrop-blur-md border-b border-slate-200 px-4 py-3 sticky top-0 z-10 shadow-sm"},e.createElement("div",{className:"flex items-center justify-between max-w-5xl mx-auto w-full"},e.createElement("div",{className:"flex items-center gap-3"},e.createElement("button",{onClick:()=>L?L():N("/dashboard/konsultasi"),className:"p-2 -ml-2 hover:bg-slate-100 rounded-full transition-colors text-slate-600"},e.createElement(re,{className:"w-5 h-5"})),e.createElement("div",{className:"flex items-center gap-3"},e.createElement("div",{className:"relative"},e.createElement("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-green-100 to-emerald-100 flex items-center justify-center border border-green-200 text-green-700 font-bold text-sm"},i.kader?.name?.substring(0,2).toUpperCase()||"KD"),i.kader?.is_online&&e.createElement("div",{className:"absolute bottom-0 right-0 w-3 h-3 bg-green-500 border-2 border-white rounded-full",title:"Kader Online"})),e.createElement("div",null,e.createElement("h2",{className:"text-base font-bold text-slate-800 leading-tight flex items-center gap-2"},i.title),e.createElement("div",{className:"flex items-center gap-1.5 text-xs text-slate-500"},e.createElement("span",{className:"flex items-center gap-1"},e.createElement(V,{className:"w-3 h-3"}),"Kader: ",i.kader?.name||"Petugas",i.kader?.is_online&&e.createElement("span",{className:"text-green-600 font-medium ml-1"},"• Online")),i.status==="open"?e.createElement("span",{className:"flex items-center gap-1 text-green-600 font-medium bg-green-50 px-1.5 py-0.5 rounded-full"},e.createElement("span",{className:"w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"}),"Aktif"):e.createElement("span",{className:"flex items-center gap-1 text-slate-500 bg-slate-100 px-1.5 py-0.5 rounded-full"},e.createElement(H,{className:"w-3 h-3"}),"Selesai"))))),e.createElement("div",{className:"relative",ref:k},e.createElement("button",{onClick:()=>_(!R),className:"p-2 hover:bg-slate-100 rounded-full text-slate-400 hover:text-slate-600 transition-colors"},e.createElement(ie,{className:"w-5 h-5"})),e.createElement(I,null,R&&e.createElement(h.div,{initial:{opacity:0,scale:.95,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:10},transition:{duration:.1},className:"absolute right-0 top-full mt-2 w-48 bg-white rounded-xl shadow-xl border border-slate-100 overflow-hidden z-50"},e.createElement("button",{onClick:le,className:"w-full px-4 py-3 text-left text-sm text-red-600 hover:bg-red-50 flex items-center gap-2 transition-colors"},e.createElement(J,{className:"w-4 h-4"}),"Hapus Percakapan")))))),e.createElement("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6 space-y-6 scroll-smooth"},e.createElement("div",{className:"max-w-5xl mx-auto w-full space-y-6"},e.createElement("div",{className:"flex justify-center"},e.createElement("span",{className:"text-xs font-medium text-slate-400 bg-slate-100 px-3 py-1 rounded-full"},new Date(i.created_at).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"}))),e.createElement(I,{initial:!1},i.messages.map((a,l)=>{const n=ne(a);return e.createElement(h.div,{key:a.id,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:`flex ${n?"justify-end":"justify-start"}`},e.createElement("div",{className:`flex flex-col max-w-[85%] sm:max-w-[70%] ${n?"items-end":"items-start"}`},a.message&&a.message.trim()&&e.createElement("div",{className:`px-5 py-3 shadow-sm relative text-sm leading-relaxed ${n?"bg-blue-600 text-white rounded-2xl rounded-tr-sm":"bg-white text-slate-800 border border-slate-100 rounded-2xl rounded-tl-sm"}`},e.createElement("p",{className:"whitespace-pre-wrap"},a.message)),a.attachment_path&&a.attachment_type==="image"&&e.createElement("div",{className:`${a.message&&a.message.trim()?"mt-2":""} rounded-xl overflow-hidden border border-slate-200 max-w-xs ${n?"ml-auto":"mr-auto"}`},e.createElement("img",{src:a.attachment_path,alt:"Attachment",className:"w-full h-auto object-cover",loading:"lazy"})),e.createElement("div",{className:`flex items-center gap-1 mt-1.5 text-[10px] font-medium ${n?"text-blue-900/40":"text-slate-400"}`},n&&e.createElement("span",null,"Anda"),!n&&e.createElement("span",null,a.sender_name?.split(" ")[0]),e.createElement("span",null,"•"),e.createElement("span",null,new Date(a.created_at).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})))))})),e.createElement("div",{ref:v}))),e.createElement("div",{className:"bg-white border-t border-slate-200 p-4 pb-6 sm:p-4 sticky bottom-0 z-10"},e.createElement("div",{className:"max-w-5xl mx-auto w-full"},i.status==="open"?e.createElement("form",{onSubmit:W,className:"flex items-end gap-2"},e.createElement("div",{className:"relative",ref:g},e.createElement("button",{type:"button",onClick:()=>y(!A),className:`p-3 rounded-full transition-colors mb-1 ${A?"bg-blue-100 text-blue-600":"text-slate-400 hover:text-blue-600 hover:bg-blue-50"}`,title:"Lampirkan"},e.createElement(ce,{className:"w-5 h-5"})),e.createElement(I,null,A&&e.createElement(h.div,{initial:{opacity:0,scale:.9,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:10},className:"absolute bottom-full left-0 mb-2 w-48 bg-white rounded-xl shadow-xl border border-slate-100 overflow-hidden z-20"},e.createElement("button",{type:"button",onClick:()=>P.current?.click(),className:"w-full px-4 py-3 text-left text-sm text-slate-700 hover:bg-slate-50 flex items-center gap-3 transition-colors"},e.createElement("div",{className:"w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center text-purple-600"},e.createElement(oe,{className:"w-4 h-4"})),e.createElement("span",null,"Kirim Gambar")),e.createElement("button",{type:"button",onClick:te,className:"w-full px-4 py-3 text-left text-sm text-slate-700 hover:bg-slate-50 flex items-center gap-3 transition-colors"},e.createElement("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-600"},e.createElement(me,{className:"w-4 h-4"})),e.createElement("span",null,"Data Kesehatan")))),e.createElement("input",{type:"file",ref:P,onChange:ee,accept:"image/*",className:"hidden"})),e.createElement("div",{className:"flex-1 relative group",onDragOver:a=>a.preventDefault(),onDrop:a=>{a.preventDefault();const l=a.dataTransfer.files[0];if(l&&l.type.startsWith("image/")){if(l.size>5*1024*1024){alert("Ukuran file maksimal 5MB");return}r(l),m(URL.createObjectURL(l))}}},e.createElement(h.div,{className:"absolute inset-0 bg-slate-100 rounded-[24px] pointer-events-none",animate:{backgroundColor:u.trim()||t?"#ffffff":"#f1f5f9",borderColor:u.trim()||t?"#bfdbfe":"transparent",boxShadow:u.trim()||t?"0 4px 6px -1px rgba(59, 130, 246, 0.1), 0 2px 4px -1px rgba(59, 130, 246, 0.06)":"none",borderWidth:"1px"}}),e.createElement("div",{className:"relative flex flex-col"},t&&e.createElement("div",{className:"px-4 pt-4 pb-0"},e.createElement("div",{className:"relative inline-block"},e.createElement("img",{src:c,alt:"Preview",className:"h-20 w-auto rounded-lg border border-slate-200 object-cover"}),e.createElement("button",{type:"button",onClick:G,className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-0.5 hover:bg-red-600 shadow-sm"},e.createElement(de,{className:"w-3 h-3"})))),e.createElement("textarea",{value:u,onChange:a=>E(a.target.value),placeholder:"Ketik pesan...",rows:"1",className:"w-full bg-transparent border-none focus:ring-0 px-5 py-3 text-slate-800 placeholder:text-slate-400 resize-none max-h-32 min-h-[48px] rounded-[24px]",style:{height:"auto",minHeight:"48px"},onInput:a=>{a.target.style.height="auto",a.target.style.height=a.target.scrollHeight+"px"},onKeyDown:a=>{a.key==="Enter"&&!a.shiftKey&&(a.preventDefault(),W(a))},onPaste:a=>{const l=a.clipboardData?.items;if(l){for(let n=0;n<l.length;n++)if(l[n].type.indexOf("image")!==-1){const d=l[n].getAsFile();if(d){if(d.size>5*1024*1024){alert("Ukuran file maksimal 5MB");return}r(d),m(URL.createObjectURL(d)),a.preventDefault()}}}},disabled:$}))),e.createElement(h.button,{whileHover:{scale:1.05},whileTap:{scale:.95},type:"submit",disabled:$||!u.trim()&&!t,className:`w-12 h-12 flex items-center justify-center rounded-full transition-all mb-1 ${u.trim()||t?"bg-blue-600 text-white shadow-lg shadow-blue-200 hover:shadow-blue-300":"bg-slate-100 text-slate-400 cursor-not-allowed"}`},$?e.createElement("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):e.createElement(ue,{className:"w-5 h-5 ml-0.5"}))):e.createElement("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-4 text-center"},e.createElement("div",{className:"flex items-center justify-center gap-2 text-slate-500 mb-1"},e.createElement(H,{className:"w-5 h-5"}),e.createElement("span",{className:"font-semibold"},"Sesi Selesai")),e.createElement("p",{className:"text-sm text-slate-400"},"Percakapan ini telah ditutup.")))),e.createElement(I,null,T&&e.createElement("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4"},e.createElement(h.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>!w&&D(!1)}),e.createElement(h.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"bg-white rounded-2xl shadow-xl w-full max-w-sm relative overflow-hidden"},e.createElement("div",{className:"p-6 text-center"},e.createElement("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4"},e.createElement(Z,{className:"w-8 h-8 text-red-600"})),e.createElement("h3",{className:"text-lg font-bold text-slate-800 mb-2"},"Hapus Percakapan?"),e.createElement("p",{className:"text-slate-500 text-sm mb-6"},"Apakah Anda yakin ingin menghapus percakapan ini? Tindakan ini tidak dapat dibatalkan."),e.createElement("div",{className:"flex gap-3"},e.createElement("button",{onClick:()=>D(!1),disabled:w,className:"flex-1 px-4 py-2.5 bg-slate-100 text-slate-700 rounded-xl hover:bg-slate-200 font-medium transition-colors disabled:opacity-50"},"Batal"),e.createElement("button",{onClick:se,disabled:w,className:"flex-1 px-4 py-2.5 bg-red-600 text-white rounded-xl hover:bg-red-700 font-medium transition-colors shadow-lg shadow-red-200 disabled:opacity-50 flex items-center justify-center gap-2"},w?e.createElement(e.Fragment,null,e.createElement("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.createElement("span",null,"Menghapus...")):e.createElement("span",null,"Hapus"))))))))}function we(){const{id:f}=q(),[L,C]=s.useState(!0),[O,K]=s.useState(null),[o,N]=s.useState([]),[p,B]=s.useState("all"),[U,M]=s.useState(null),[b,i]=s.useState({show:!1,id:null}),[z,u]=s.useState(!1),[E,$]=s.useState(""),x=X(),{getCachedData:R,setCachedData:_,invalidateCache:w}=Y();s.useEffect(()=>{S(p)},[p]),s.useEffect(()=>{const t=setInterval(()=>{document.visibilityState==="visible"&&S(p,!0)},3e4);return()=>clearInterval(t)},[p]);const S=async(t="all",r=!1)=>{try{r?u(!0):C(!0),K(null);const c=`consultations_${t}`,m=R(c);if(m&&!r){N(m),C(!1);return}const v=t!=="all"?{status:t}:{},g=(await j.get("/parent/consultations",{params:v})).data.data;N(g),_(c,g)}catch(c){const m=c.response?.data?.message||"Gagal memuat data konsultasi. Silakan coba lagi.";K(m),console.error("Consultations fetch error:",c)}finally{r?u(!1):C(!1)}},T=(t,r)=>{t.stopPropagation(),i({show:!0,id:r})},D=async()=>{const t=b.id;if(t)try{M(t),i({show:!1,id:null}),await j.delete(`/parent/consultations/${t}`),N(r=>r.filter(c=>c.id!==t)),w("consultations_all"),w("consultations_open"),w("consultations_closed"),f&&parseInt(f)===t&&x("/dashboard/konsultasi")}catch(r){console.error("Delete error:",r),alert("Gagal menghapus percakapan.")}finally{M(null)}},A=t=>{const r=new Date,c=new Date(t),m=r-c,v=Math.floor(m/6e4),k=Math.floor(m/36e5),g=Math.floor(m/864e5);return v<1?"Baru saja":v<60?`${v}m`:k<24?`${k}j`:g<7?`${g}h`:c.toLocaleDateString("id-ID",{day:"numeric",month:"short"})},y=o.filter(t=>t.title.toLowerCase().includes(E.toLowerCase())||t.kader?.name.toLowerCase().includes(E.toLowerCase()));return L&&o.length===0?e.createElement(pe,null):e.createElement("div",{className:"flex flex-col h-full w-full bg-white overflow-hidden"},e.createElement(h.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},className:"relative z-50 flex-shrink-0"},e.createElement(he,{title:"Konsultasi",subtitle:"Tanya Ahli Gizi",showProfile:!0})),e.createElement("div",{className:"flex flex-1 h-full overflow-hidden"},e.createElement("div",{className:`flex-col h-full bg-white border-r border-slate-200 md:w-[400px] flex-shrink-0 ${f?"hidden md:flex":"flex w-full"}`},e.createElement("div",{className:"bg-slate-50 border-b border-slate-200 px-4 py-4"},e.createElement("div",{className:"flex items-center justify-between mb-4"},e.createElement("h1",{className:"text-xl font-bold text-slate-800"},"Konsultasi"),e.createElement("div",{className:"flex items-center gap-2"},z&&e.createElement("div",{className:"w-4 h-4 border-2 border-slate-300 border-t-blue-500 rounded-full animate-spin",title:"Memperbarui..."}),e.createElement("button",{onClick:()=>x("/dashboard/konsultasi/create"),className:"hidden md:block p-2 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-colors shadow-sm",title:"Buat Konsultasi Baru"},e.createElement(Q,{className:"w-5 h-5"})))),e.createElement("div",{className:"relative mb-3"},e.createElement(be,{className:"absolute left-3 top-2.5 w-4 h-4 text-slate-400"}),e.createElement("input",{type:"text",placeholder:"Cari konsultasi atau kader...",value:E,onChange:t=>$(t.target.value),className:"w-full pl-9 pr-4 py-2 bg-white border border-slate-200 rounded-lg text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})),e.createElement("div",{className:"flex gap-1 bg-slate-200/50 p-1 rounded-lg w-full"},["all","open","closed"].map(t=>e.createElement("button",{key:t,onClick:()=>B(t),className:`flex-1 py-1.5 rounded-md text-xs font-medium transition-all duration-200 capitalize ${p===t?"bg-white text-slate-800 shadow-sm":"text-slate-500 hover:text-slate-700"}`},t==="all"?"Semua":t==="open"?"Aktif":"Selesai")))),e.createElement("div",{className:"flex-1 overflow-y-auto"},L?e.createElement("div",{className:"p-4 space-y-4"},[1,2,3,4].map(t=>e.createElement("div",{key:t,className:"flex gap-3 items-center animate-pulse"},e.createElement("div",{className:"w-12 h-12 bg-slate-200 rounded-full flex-shrink-0"}),e.createElement("div",{className:"flex-1 space-y-2"},e.createElement("div",{className:"h-4 bg-slate-200 rounded w-3/4"}),e.createElement("div",{className:"h-3 bg-slate-200 rounded w-1/2"}))))):y.length===0?e.createElement("div",{className:"flex flex-col items-center justify-center h-64 text-center p-6"},e.createElement("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mb-4"},e.createElement(xe,{className:"w-8 h-8 text-slate-300"})),e.createElement("p",{className:"text-slate-500 text-sm"},E?"Tidak ada hasil pencarian.":"Belum ada percakapan.")):e.createElement("div",{className:"divide-y divide-slate-100"},y.map(t=>e.createElement("div",{key:t.id,onClick:()=>x(`/dashboard/konsultasi/${t.id}`),className:`group p-4 hover:bg-slate-50 cursor-pointer transition-colors relative ${f&&parseInt(f)===t.id?"bg-blue-50/60 hover:bg-blue-50":""}`},e.createElement("div",{className:"flex items-start gap-3"},e.createElement("div",{className:"relative flex-shrink-0"},e.createElement("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-100 to-indigo-100 flex items-center justify-center text-blue-600 font-bold text-sm border border-blue-200"},t.kader?.name?.substring(0,2).toUpperCase()||"KD"),t.kader?.is_online&&e.createElement("div",{className:"absolute bottom-0 right-0 w-3.5 h-3.5 bg-green-500 border-2 border-white rounded-full",title:"Online"})),e.createElement("div",{className:"flex-1 min-w-0"},e.createElement("div",{className:"flex justify-between items-baseline mb-1"},e.createElement("h3",{className:"text-sm font-bold text-slate-800 truncate pr-2"},t.title),e.createElement("span",{className:"text-[10px] text-slate-400 flex-shrink-0"},A(t.updated_at))),e.createElement("div",{className:"flex justify-between items-end"},e.createElement("p",{className:"text-xs text-slate-500 line-clamp-1 mr-2"},t.last_message?e.createElement(e.Fragment,null,e.createElement("span",{className:"font-medium text-slate-700"},t.last_message.sender_name.split(" ")[0]," :"),t.last_message.attachment_type==="image"?e.createElement("span",{className:"flex items-center gap-1 text-slate-500"},e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},e.createElement("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}),e.createElement("circle",{cx:"9",cy:"9",r:"2"}),e.createElement("path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"})),"Foto"):" "+t.last_message.message):e.createElement("span",{className:"italic text-slate-400"},"Belum ada pesan")),t.status==="open"?e.createElement("div",{className:"w-2.5 h-2.5 rounded-full bg-green-500 flex-shrink-0",title:"Aktif"}):e.createElement(H,{className:"w-3.5 h-3.5 text-slate-400 flex-shrink-0",title:"Selesai"})))),e.createElement("button",{onClick:r=>T(r,t.id),className:"absolute right-12 top-1/2 -translate-y-1/2 p-1.5 text-slate-400 hover:text-red-600 bg-white/90 hover:bg-red-50 rounded-full opacity-0 group-hover:opacity-100 transition-all shadow-sm border border-slate-100 hover:border-red-100 z-10",title:"Hapus"},e.createElement(J,{className:"w-4 h-4"})))))),e.createElement("button",{onClick:()=>x("/dashboard/konsultasi/create"),className:"md:hidden fixed bottom-24 right-6 w-14 h-14 bg-blue-600 text-white rounded-full shadow-lg hover:bg-blue-700 transition-all z-40 flex items-center justify-center active:scale-95",title:"Buat Konsultasi Baru"},e.createElement(Q,{className:"w-8 h-8"}))),e.createElement("div",{className:`flex-1 flex-col h-full bg-slate-50 relative ${f?"flex":"hidden md:flex"}`},e.createElement("div",{className:"absolute inset-0 opacity-[0.06] pointer-events-none",style:{backgroundImage:'url("https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png")'}}),f?e.createElement(ge,{selectedId:f,onBack:()=>x("/dashboard/konsultasi"),onDeleteSuccess:()=>{x("/dashboard/konsultasi"),S(p)},className:"h-full z-10"}):e.createElement("div",{className:"flex-1 flex flex-col items-center justify-center text-center p-8 z-10"},e.createElement("div",{className:"w-80 h-80 mb-6 relative"},e.createElement("div",{className:"absolute inset-0 bg-blue-100/50 rounded-full blur-3xl opacity-50 animate-pulse"}),e.createElement("img",{src:"/images/chat-placeholder.png?v=2",alt:"Select Chat",className:"w-full h-full object-contain relative z-10 drop-shadow-2xl"})),e.createElement("h2",{className:"text-3xl font-bold text-slate-800 mb-3"},"NutriLogic Web"),e.createElement("p",{className:"text-slate-500 max-w-md text-lg leading-relaxed"},"Kirim dan terima pesan konsultasi dengan kader kesehatan secara real-time. Pilih percakapan di sebelah kiri untuk memulai."),e.createElement("div",{className:"mt-8 flex items-center gap-2 text-slate-400 text-sm font-medium bg-white/50 px-4 py-2 rounded-full border border-slate-100"},e.createElement("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.createElement("span",null,"Status Kader Real-time")))),e.createElement(I,null,b.show&&e.createElement("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4"},e.createElement(h.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>i({show:!1,id:null})}),e.createElement(h.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"bg-white rounded-2xl shadow-xl w-full max-w-sm relative overflow-hidden z-50"},e.createElement("div",{className:"p-6 text-center"},e.createElement("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4"},e.createElement(Z,{className:"w-8 h-8 text-red-600"})),e.createElement("h3",{className:"text-lg font-bold text-slate-800 mb-2"},"Hapus Percakapan?"),e.createElement("p",{className:"text-slate-500 text-sm mb-6"},"Apakah Anda yakin ingin menghapus percakapan ini? Tindakan ini tidak dapat dibatalkan."),e.createElement("div",{className:"flex gap-3"},e.createElement("button",{onClick:()=>i({show:!1,id:null}),className:"flex-1 px-4 py-2.5 bg-slate-100 text-slate-700 rounded-xl hover:bg-slate-200 font-medium transition-colors"},"Batal"),e.createElement("button",{onClick:D,className:"flex-1 px-4 py-2.5 bg-red-600 text-white rounded-xl hover:bg-red-700 font-medium transition-colors shadow-lg shadow-red-200"},"Hapus"))))))))}export{we as default};
