import{w as Y,r,b as T,R as e,aa as L,K as B,A as P,m as y,L as O,U as I,N as R,a8 as U,S as d,ab as F,H as G,J as Q,ac as V,a5 as _,a7 as z,O as X,ad as Z,Z as H,ae as J,af as ee,v as te,P as W}from"./app-BXoXraSC.js";import{S as ae}from"./sparkles-BvYiATbG.js";const le=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],q=Y("circle-x",le);const re=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],ne=Y("layout-grid",re);const se=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],ce=Y("user-plus",se),K=r.memo(function({childId:n,onSuccess:s,initialData:t}){const[l,i]=r.useState({time_of_day:"pagi",description:"",ingredients:"",portion:"habis",notes:""}),[f,m]=r.useState(!1),[p,u]=r.useState(null),[D,h]=r.useState(!1),[S,v]=r.useState(!1),[j,$]=r.useState(!1),w=r.useRef(null);r.useEffect(()=>{t&&(i({time_of_day:t.time_of_day||"siang",description:t.description||"",ingredients:t.ingredients||"",portion:"habis",notes:t.notes||""}),$(t.source==="nutri-assist"))},[t]);const C=[{value:"pagi",label:"Pagi"},{value:"siang",label:"Siang"},{value:"malam",label:"Malam"},{value:"snack",label:"Snack"}],c=[{value:"habis",label:"Habis"},{value:"setengah",label:"Setengah"},{value:"sedikit",label:"Sedikit"},{value:"tidak_mau",label:"Tidak Mau"}],g=r.useCallback(async a=>{if(a.preventDefault(),!l.description.trim()){u("Nama makanan harus diisi"),w.current&&w.current.focus();return}m(!0),u(null);try{await T.post("/meal-logs",{child_id:n,eaten_at:new Date().toISOString().split("T")[0],time_of_day:l.time_of_day,description:l.description,ingredients:l.ingredients||null,portion:l.portion,notes:l.notes||null,source:"ortu"}),h(!0),setTimeout(()=>h(!1),2500),i({time_of_day:"pagi",description:"",ingredients:"",portion:"habis",notes:""}),s&&s()}catch(o){console.error("Error adding meal log:",o);let E="Gagal menyimpan data. Silakan coba lagi.";o.response?.data?.message&&(o.response.data.message.includes("SQLSTATE")?E="Terjadi kesalahan sistem. Mohon hubungi admin.":E=o.response.data.message),u(E)}finally{m(!1)}},[n,l,s]);return e.createElement("section",{className:"bg-white rounded-2xl border border-gray-200 p-6 shadow-sm"},e.createElement("h3",{className:"text-lg font-bold text-gray-900 mb-6 flex items-center gap-2"},e.createElement(L,{className:"w-5 h-5 text-gray-400"}),"Catat Makanan"),j&&e.createElement("div",{className:"mb-6 p-3 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-xl flex items-center gap-3"},e.createElement("div",{className:"p-2 bg-blue-100 rounded-lg"},e.createElement(ae,{className:"w-4 h-4 text-blue-600"})),e.createElement("div",null,e.createElement("p",{className:"text-sm font-semibold text-blue-800"},"Dari Nutri-Assist"),e.createElement("p",{className:"text-xs text-blue-600"},"Data terisi otomatis dari rekomendasi. Sesuaikan jika perlu."))),e.createElement("form",{onSubmit:g,className:"space-y-6"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",{className:"space-y-2"},e.createElement("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider"},"Waktu"),e.createElement("div",{className:"flex gap-2"},C.map(a=>e.createElement("button",{key:a.value,type:"button",onClick:()=>i({...l,time_of_day:a.value}),className:`flex-1 py-2 text-sm font-medium rounded-lg transition-colors ${l.time_of_day===a.value?"bg-blue-600 text-white shadow-sm shadow-blue-200":"bg-gray-50 text-gray-600 hover:bg-blue-50 hover:text-blue-600"}`},a.label)))),e.createElement("div",{className:"space-y-2 relative"},e.createElement("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider"},"Porsi"),e.createElement("button",{type:"button",onClick:()=>v(!S),className:"w-full flex items-center justify-between p-2.5 bg-gray-50 rounded-lg text-sm font-medium text-gray-900 hover:bg-blue-50 transition-colors focus:ring-2 focus:ring-blue-200"},e.createElement("span",null,c.find(a=>a.value===l.portion)?.label||"Pilih Porsi"),e.createElement(B,{className:`w-4 h-4 text-gray-400 transition-transform duration-200 ${S?"rotate-180":""}`})),e.createElement(P,null,S&&e.createElement(e.Fragment,null,e.createElement("div",{className:"fixed inset-0 z-30",onClick:()=>v(!1)}),e.createElement(y.div,{initial:{opacity:0,y:8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:8,scale:.95},transition:{duration:.2},className:"absolute z-40 w-full mt-2 bg-white border border-gray-100 rounded-xl shadow-xl overflow-hidden"},e.createElement("div",{className:"p-1.5 space-y-1"},c.map(a=>{const o=l.portion===a.value;return e.createElement("button",{key:a.value,type:"button",onClick:()=>{i({...l,portion:a.value}),v(!1)},className:`w-full flex items-center justify-between px-3 py-2.5 rounded-lg text-sm font-medium transition-colors ${o?"bg-blue-50 text-blue-700":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`},e.createElement("span",null,a.label),o&&e.createElement(O,{className:"w-4 h-4 text-blue-600"}))}))))))),e.createElement("div",{className:"space-y-2"},e.createElement("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider"},"Menu Makanan"),e.createElement("div",{className:"relative"},e.createElement(I,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.createElement("input",{ref:w,type:"text",value:l.description,onChange:a=>{i({...l,description:a.target.value}),p&&u(null)},placeholder:"Apa yang dimakan si kecil?",className:`w-full pl-10 pr-4 py-3 bg-gray-50 border-none rounded-xl text-base font-medium text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-blue-500/20 focus:bg-blue-50/30 transition-all ${p?"ring-2 ring-red-500/20 bg-red-50/50":""}`}))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",{className:"space-y-2"},e.createElement("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider"},"Bahan (Opsional)"),e.createElement("input",{type:"text",value:l.ingredients,onChange:a=>i({...l,ingredients:a.target.value}),placeholder:"Contoh: Bayam, Wortel",className:"w-full px-3 py-2 bg-transparent border-b border-gray-200 text-sm text-gray-900 placeholder-gray-400 focus:border-blue-600 focus:outline-none transition-colors"})),e.createElement("div",{className:"space-y-2"},e.createElement("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider"},"Catatan (Opsional)"),e.createElement("input",{type:"text",value:l.notes,onChange:a=>i({...l,notes:a.target.value}),placeholder:"Ada catatan khusus?",className:"w-full px-3 py-2 bg-transparent border-b border-gray-200 text-sm text-gray-900 placeholder-gray-400 focus:border-blue-600 focus:outline-none transition-colors"}))),e.createElement("div",{className:"flex items-center justify-between pt-2"},e.createElement("div",{className:"flex-1 mr-4"},e.createElement(P,null,p&&e.createElement(y.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0},className:"text-red-600 text-xs font-medium flex items-center gap-1"},e.createElement(R,{className:"w-3 h-3"}),p),D&&e.createElement(y.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0},className:"text-green-600 text-xs font-medium flex items-center gap-1"},e.createElement(O,{className:"w-3 h-3"}),"Tersimpan"))),e.createElement("button",{type:"submit",disabled:f,className:"px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold text-sm transition-all shadow-lg shadow-blue-200 hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"},f?e.createElement(U,{className:"w-4 h-4 animate-spin"}):e.createElement(L,{className:"w-4 h-4"}),"Simpan"))))});function ie(){return e.createElement(y.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.4},className:"flex flex-row items-center gap-6 py-4"},e.createElement("div",{className:"w-24 h-24 bg-gradient-to-br from-blue-50 to-indigo-50 rounded-full flex items-center justify-center animate-pulse shrink-0"},e.createElement(I,{className:"w-10 h-10 text-blue-400/50"})),e.createElement("div",null,e.createElement("h3",{className:"text-lg font-semibold text-gray-600 mb-1"},"Belum Ada Catatan"),e.createElement("p",{className:"text-gray-500 max-w-lg text-sm leading-relaxed"},"Jurnal makan hari ini masih kosong. Yuk, mulai catat apa yang dimakan si kecil!")))}function oe(){return e.createElement("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 rounded-2xl shadow-xl p-6 md:p-10 border-2 border-blue-200"},e.createElement("div",{className:"text-center mb-6 md:mb-8 space-y-3"},e.createElement(d,{className:"h-8 md:h-10 w-3/4 mx-auto",variant:"text"}),e.createElement(d,{className:"h-5 w-1/2 mx-auto",variant:"text"})),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6 mb-6 md:mb-8"},Array.from({length:3}).map((b,n)=>e.createElement("div",{key:n,className:"relative p-5 md:p-7 rounded-2xl border-2 border-gray-200 bg-white min-h-[120px] md:min-h-[140px]"},e.createElement("div",{className:"flex flex-col items-center gap-2 md:gap-3"},e.createElement(d,{className:"w-12 h-12 md:w-14 md:h-14 rounded-full"}),e.createElement(d,{className:"w-9 h-9 rounded-lg"}),e.createElement(d,{className:"h-5 w-20",variant:"text"}))))))}const me=r.memo(function({childId:n,childName:s,onSuccess:t}){const[l,i]=r.useState(null),[f,m]=r.useState(""),[p,u]=r.useState(!0),[D,h]=r.useState(!1),[S,v]=r.useState(null),j=[{value:"consumed",label:"Habis",icon:F,color:"bg-green-600 hover:bg-green-700 active:bg-green-800",textColor:"text-green-800",bgColor:"bg-green-50",borderColor:"border-green-300",emoji:"âœ“",hoverBorder:"hover:border-green-400"},{value:"partial",label:"Sebagian",icon:R,color:"bg-yellow-600 hover:bg-yellow-700 active:bg-yellow-800",textColor:"text-yellow-800",bgColor:"bg-yellow-50",borderColor:"border-yellow-300",emoji:"~",hoverBorder:"hover:border-yellow-400"},{value:"refused",label:"Tidak Mau",icon:q,color:"bg-red-600 hover:bg-red-700 active:bg-red-800",textColor:"text-red-800",bgColor:"bg-red-50",borderColor:"border-red-300",emoji:"âœ—",hoverBorder:"hover:border-red-400"}];r.useEffect(()=>{n&&$()},[n]);const $=async()=>{u(!0);try{const c=new Date,a=(await T.get(`/pmt-logs/child/${n}`,{params:{month:c.getMonth()+1,year:c.getFullYear()}})).data.data||[],o=c.getFullYear(),E=String(c.getMonth()+1).padStart(2,"0"),x=String(c.getDate()).padStart(2,"0"),N=`${o}-${E}-${x}`,k=a.find(M=>(M.date?.split("T")[0]||M.date?.substring(0,10))===N);k?(i(k.status),m(k.notes||"")):(i(null),m(""))}catch(c){console.error("Error fetching today status:",c)}finally{u(!1)}},w=r.useCallback(async c=>{h(!0),v(null);try{const g=new Date,a=g.getFullYear(),o=String(g.getMonth()+1).padStart(2,"0"),E=String(g.getDate()).padStart(2,"0"),x=`${a}-${o}-${E}`;await T.post("/pmt-logs",{child_id:n,date:x,status:c,notes:f||null}),i(c),t&&t()}catch(g){console.error("Error saving PMT status:",g),v(g.response?.data?.message||"Gagal menyimpan status. Silakan coba lagi.")}finally{h(!1)}},[n,f,t]),C=r.useCallback(async c=>{if(m(c),l)try{const g=new Date,a=g.getFullYear(),o=String(g.getMonth()+1).padStart(2,"0"),E=String(g.getDate()).padStart(2,"0"),x=`${a}-${o}-${E}`;await T.post("/pmt-logs",{child_id:n,date:x,status:l,notes:c||null})}catch(g){console.error("Error saving notes:",g)}},[n,l]);return p?e.createElement(oe,null):(j.find(c=>c.value===l),e.createElement(y.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white rounded-3xl shadow-sm border border-gray-100 p-6 md:p-8"},e.createElement("div",{className:"text-center mb-8 space-y-2"},e.createElement("h3",{className:"text-xl md:text-2xl font-bold text-gray-900"},"Apakah ",e.createElement("span",{className:"text-blue-600"},s)," sudah makan PMT?"),e.createElement("p",{className:"text-gray-500 font-medium"},new Date().toLocaleDateString("id-ID",{weekday:"long",day:"numeric",month:"long",year:"numeric"}))),e.createElement("div",{className:"grid grid-cols-3 gap-2 md:gap-4 mb-8"},j.map(c=>{const g=c.icon,a=l===c.value;return e.createElement(y.button,{key:c.value,whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>w(c.value),disabled:D,className:`relative p-3 md:p-6 rounded-2xl border transition-all duration-200 flex flex-col items-center gap-1 md:gap-3 ${a?`${c.bgColor} ${c.textColor} ${c.borderColor} ring-2 ring-offset-2 ring-blue-100`:"bg-white border-gray-100 text-gray-600 hover:border-gray-200 hover:bg-gray-50"}`},a&&e.createElement(y.div,{initial:{scale:0},animate:{scale:1},className:"absolute top-2 right-2 md:top-3 md:right-3"},e.createElement(F,{className:"w-4 h-4 md:w-5 md:h-5"})),e.createElement(g,{className:`w-6 h-6 md:w-8 md:h-8 ${a?c.textColor:"text-gray-400"}`}),e.createElement("span",{className:"font-semibold text-xs md:text-lg text-center leading-tight"},c.label))})),e.createElement(P,null,l&&e.createElement(y.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"overflow-hidden"},e.createElement("div",{className:"bg-gray-50 rounded-2xl p-4 md:p-6"},e.createElement("label",{htmlFor:"pmt-notes",className:"block text-sm font-semibold text-gray-700 mb-2"},"Catatan Tambahan"),e.createElement("textarea",{id:"pmt-notes",value:f,onChange:c=>C(c.target.value),placeholder:"Contoh: Anak sangat suka menunya...",rows:2,maxLength:500,className:"w-full px-4 py-3 bg-white border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-100 focus:border-blue-400 focus:outline-none transition-all resize-none"})))),e.createElement(P,null,l&&!S&&e.createElement(y.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-6 flex items-center justify-center gap-2 text-green-600 bg-green-50 py-3 px-4 rounded-xl text-sm font-medium"},e.createElement(F,{className:"w-4 h-4"}),"Data berhasil disimpan"))))});function de(){return e.createElement("div",{className:"bg-white rounded-2xl shadow-sm p-6 border border-gray-100"},e.createElement("div",{className:"flex items-center justify-between mb-6"},e.createElement("div",{className:"flex items-center gap-3"},e.createElement(d,{className:"w-9 h-9 rounded-lg"}),e.createElement(d,{className:"h-6 w-32",variant:"text"})),e.createElement("div",{className:"flex items-center gap-2"},e.createElement(d,{className:"w-9 h-9 rounded-lg"}),e.createElement(d,{className:"h-9 w-40 rounded-lg"}),e.createElement(d,{className:"w-9 h-9 rounded-lg"}))),e.createElement("div",{className:"grid grid-cols-7 gap-2 mb-2"},Array.from({length:7}).map((t,l)=>e.createElement("div",{key:l,className:"text-center py-2"},e.createElement(d,{className:"h-3 w-8 mx-auto",variant:"text"})))),e.createElement("div",{className:"grid grid-cols-7 gap-2"},Array.from({length:35}).map((t,l)=>e.createElement(d,{key:l,className:"aspect-square rounded-lg"}))),e.createElement("div",{className:"mt-6 pt-6 border-t border-gray-200"},e.createElement(d,{className:"h-3 w-24 mb-3",variant:"text"}),e.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3"},Array.from({length:4}).map((t,l)=>e.createElement("div",{key:l,className:"flex items-center gap-2"},e.createElement(d,{className:"w-6 h-6 rounded"}),e.createElement(d,{className:"h-4 w-16",variant:"text"}))))))}const ue=r.memo(function({childId:n}){const[s,t]=r.useState(new Date),[l,i]=r.useState([]),[f,m]=r.useState(!1);r.useEffect(()=>{n&&p()},[n,s]);const p=async()=>{m(!0);try{const a=await T.get(`/pmt-logs/child/${n}`,{params:{month:s.getMonth()+1,year:s.getFullYear()}});i(a.data.data||[])}catch(a){console.error("Error fetching PMT logs:",a)}finally{m(!1)}},u=a=>{const o=a.getFullYear(),E=a.getMonth(),x=new Date(o,E,1),k=new Date(o,E+1,0).getDate(),M=x.getDay();return{daysInMonth:k,startingDayOfWeek:M}},D=a=>{const o=new Date(s.getFullYear(),s.getMonth(),a),E=o.getFullYear(),x=String(o.getMonth()+1).padStart(2,"0"),N=String(o.getDate()).padStart(2,"0"),k=`${E}-${x}-${N}`;return l.find(A=>A.date&&A.date.startsWith(k))?.status||null},h=r.useCallback(()=>{t(new Date(s.getFullYear(),s.getMonth()-1))},[s]),S=r.useCallback(()=>{t(new Date(s.getFullYear(),s.getMonth()+1))},[s]),{daysInMonth:v,startingDayOfWeek:j}=u(s),$=Array.from({length:v},(a,o)=>o+1),w=Array.from({length:j},(a,o)=>o),C=["Min","Sen","Sel","Rab","Kam","Jum","Sab"],c=new Date,g=s.getMonth()===c.getMonth()&&s.getFullYear()===c.getFullYear();return f?e.createElement(de,null):e.createElement("div",{className:"bg-white rounded-3xl shadow-sm border border-gray-100 p-6 md:p-8 h-full flex flex-col"},e.createElement("div",{className:"flex items-center justify-between mb-6"},e.createElement("div",null,e.createElement("h3",{className:"text-lg font-bold text-gray-900"},"Kalender PMT"),e.createElement("p",{className:"text-sm text-gray-500 capitalize"},s.toLocaleDateString("id-ID",{month:"long",year:"numeric"}))),e.createElement("div",{className:"flex gap-1"},e.createElement("button",{onClick:h,className:"p-2 hover:bg-gray-100 rounded-lg text-gray-600 transition-colors"},e.createElement(G,{className:"w-5 h-5"})),e.createElement("button",{onClick:S,className:"p-2 hover:bg-gray-100 rounded-lg text-gray-600 transition-colors"},e.createElement(Q,{className:"w-5 h-5"})))),e.createElement("div",{className:"flex-1 flex flex-col justify-center"},e.createElement("div",{className:"grid grid-cols-7 gap-1 mb-2"},C.map(a=>e.createElement("div",{key:a,className:"text-center text-xs font-medium text-gray-400 py-1"},a))),e.createElement("div",{className:"grid grid-cols-7 gap-1"},w.map((a,o)=>e.createElement("div",{key:`empty-${o}`,className:"aspect-square"})),$.map(a=>{const o=D(a),E=g&&a===c.getDate(),x=new Date(s.getFullYear(),s.getMonth(),a)>c;let N="bg-gray-50 text-gray-700 hover:bg-gray-100";return o==="consumed"&&(N="bg-green-500 text-white shadow-md shadow-green-200"),o==="partial"&&(N="bg-yellow-500 text-white shadow-md shadow-yellow-200"),o==="refused"&&(N="bg-red-500 text-white shadow-md shadow-red-200"),x&&(N="bg-transparent text-gray-300"),e.createElement("div",{key:a,className:`aspect-square rounded-lg flex flex-col items-center justify-center relative ${N} ${E?"ring-2 ring-blue-500 ring-offset-2":""}`},e.createElement("span",{className:"text-sm font-medium"},a),o&&e.createElement("span",{className:"text-[10px] leading-none mt-0.5"},o==="consumed"&&"âœ“",o==="partial"&&"~",o==="refused"&&"âœ—"))}))))});function ge(){return e.createElement("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 rounded-2xl shadow-sm p-6 border border-blue-100"},e.createElement("div",{className:"flex items-center gap-3 mb-6"},e.createElement(d,{className:"w-9 h-9 rounded-lg"}),e.createElement("div",{className:"flex-1"},e.createElement(d,{className:"h-6 w-40 mb-2",variant:"text"}),e.createElement(d,{className:"h-4 w-24",variant:"text"}))),e.createElement("div",{className:"mb-6"},e.createElement("div",{className:"flex items-end justify-between mb-2"},e.createElement(d,{className:"h-4 w-32",variant:"text"}),e.createElement(d,{className:"h-9 w-20",variant:"text"})),e.createElement(d,{className:"h-4 w-full rounded-full"}),e.createElement(d,{className:"h-3 w-48 mt-2",variant:"text"})),e.createElement("div",{className:"grid grid-cols-3 gap-3"},Array.from({length:3}).map((b,n)=>e.createElement("div",{key:n,className:"bg-white rounded-xl p-4 border border-gray-100"},e.createElement("div",{className:"flex flex-col items-center text-center"},e.createElement(d,{className:"w-9 h-9 rounded-lg mb-2"}),e.createElement(d,{className:"h-8 w-12 mb-1",variant:"text"}),e.createElement(d,{className:"h-3 w-16",variant:"text"}))))),e.createElement("div",{className:"mt-4"},e.createElement(d,{className:"h-12 w-full rounded-lg"})))}const pe=r.memo(function({childId:n}){const[s,t]=r.useState(null),[l,i]=r.useState(!0);r.useEffect(()=>{n&&f()},[n]);const f=async()=>{i(!0);try{const h=await T.get(`/pmt-logs/child/${n}/stats`);t(h.data.data)}catch(h){console.error("Error fetching PMT stats:",h)}finally{i(!1)}};if(l)return e.createElement(ge,null);const m=s||{month:new Date().toLocaleDateString("id-ID",{month:"long",year:"numeric"}),total_logged:0,total_days:new Date(new Date().getFullYear(),new Date().getMonth()+1,0).getDate(),compliance_rate:0,consumed:0,partial:0,refused:0},p=m.compliance_rate||0,u=h=>h>=80?"text-green-700":h>=60?"text-yellow-700":"text-red-700",D=h=>h>=80?"bg-green-600":h>=60?"bg-yellow-600":"bg-red-600";return e.createElement("div",{className:"bg-white rounded-3xl shadow-sm border border-gray-100 p-6 md:p-8 h-full flex flex-col"},e.createElement("div",{className:"flex items-center justify-between mb-8"},e.createElement("div",null,e.createElement("h3",{className:"text-lg font-bold text-gray-900"},"Statistik Bulan Ini"),e.createElement("p",{className:"text-sm text-gray-500"},m.month)),e.createElement("div",{className:"p-2 bg-blue-50 rounded-lg"},e.createElement(V,{className:"w-5 h-5 text-blue-600"}))),e.createElement("div",{className:"mb-8"},e.createElement("div",{className:"flex items-end justify-between mb-2"},e.createElement("span",{className:"text-sm font-medium text-gray-600"},"Tingkat Kepatuhan"),e.createElement("span",{className:`text-3xl font-bold ${u(p)}`},p,"%")),e.createElement("div",{className:"h-3 bg-gray-100 rounded-full overflow-hidden"},e.createElement(y.div,{initial:{width:0},animate:{width:`${p}%`},transition:{duration:1,ease:"easeOut"},className:`h-full ${D(p)} rounded-full`})),e.createElement("p",{className:"text-xs text-gray-400 mt-2"},m.total_logged," dari ",m.total_days," hari tercatat")),e.createElement("div",{className:"grid grid-cols-3 gap-2 md:gap-4"},e.createElement("div",{className:"p-3 md:p-6 rounded-2xl bg-green-50 border border-green-200 flex flex-col items-center gap-2 text-green-800"},e.createElement(F,{className:"w-6 h-6 md:w-8 md:h-8 text-green-600"}),e.createElement("div",{className:"text-2xl md:text-3xl font-bold"},m.consumed),e.createElement("div",{className:"text-xs md:text-sm font-medium text-center leading-tight"},"Habis")),e.createElement("div",{className:"p-3 md:p-6 rounded-2xl bg-yellow-50 border border-yellow-200 flex flex-col items-center gap-2 text-yellow-800"},e.createElement(R,{className:"w-6 h-6 md:w-8 md:h-8 text-yellow-600"}),e.createElement("div",{className:"text-2xl md:text-3xl font-bold"},m.partial),e.createElement("div",{className:"text-xs md:text-sm font-medium text-center leading-tight"},"Sebagian")),e.createElement("div",{className:"p-3 md:p-6 rounded-2xl bg-red-50 border border-red-200 flex flex-col items-center gap-2 text-red-800"},e.createElement(q,{className:"w-6 h-6 md:w-8 md:h-8 text-red-600"}),e.createElement("div",{className:"text-2xl md:text-3xl font-bold"},m.refused),e.createElement("div",{className:"text-xs md:text-sm font-medium text-center leading-tight"},"Tidak Mau"))))});function xe(){return e.createElement("div",{className:"mb-6"},e.createElement(d,{className:"h-4 w-20 mb-2",variant:"text"}),e.createElement("div",{className:"relative"},e.createElement(d,{className:"w-full md:w-auto min-w-[280px] h-[44px] rounded-xl"})))}const be=r.memo(function({children:n,selectedChildId:s,onChange:t,loading:l=!1}){const[i,f]=e.useState(!1),m=n.find(p=>p.id===parseInt(s));return l?e.createElement(xe,null):n.length===0?null:e.createElement("div",{className:"relative w-full min-w-[200px]"},e.createElement("button",{onClick:()=>f(!i),className:_("w-full flex items-center justify-between","px-4 py-3.5","bg-white border border-gray-200 rounded-xl","text-gray-900 font-semibold","shadow-sm hover:border-blue-400 hover:shadow-md","focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500","transition-all duration-200")},e.createElement("div",{className:"flex items-center gap-3"},e.createElement("div",{className:"p-2 rounded-lg bg-blue-50 text-blue-600"},e.createElement(z,{className:"w-5 h-5"})),e.createElement("span",null,m?m.full_name:"Pilih Anak")),e.createElement(B,{className:_("w-5 h-5 text-gray-400 transition-transform duration-200",i&&"rotate-180")})),e.createElement(P,null,i&&e.createElement(e.Fragment,null,e.createElement("div",{className:"fixed inset-0 z-30",onClick:()=>f(!1)}),e.createElement(y.div,{initial:{opacity:0,y:8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:8,scale:.95},transition:{duration:.2},className:"absolute z-40 w-full mt-2 bg-white border border-gray-100 rounded-xl shadow-xl overflow-hidden"},e.createElement("div",{className:"p-1.5 space-y-1"},n.map(p=>{const u=parseInt(s)===p.id;return e.createElement("button",{key:p.id,onClick:()=>{t(p.id),f(!1)},className:_("w-full flex items-center justify-between","px-3 py-2.5 rounded-lg","text-sm font-medium transition-colors",u?"bg-blue-50 text-blue-700":"text-gray-600 hover:bg-gray-50 hover:text-gray-900")},e.createElement("div",{className:"flex items-center gap-3"},e.createElement(z,{className:_("w-4 h-4",u?"text-blue-600":"text-gray-400")}),p.full_name),u&&e.createElement(O,{className:"w-4 h-4 text-blue-600"}))}))))))});function ye({activeTab:b,onTabChange:n}){const[s,t]=r.useState(!1),l=[{value:"jurnal",label:"Jurnal Harian",icon:ne},{value:"pmt",label:"Pantau PMT",icon:X}],i=l.find(m=>m.value===b)||l[0],f=i.icon;return e.createElement("div",{className:"relative w-full"},e.createElement("button",{onClick:()=>t(!s),className:_("w-full flex items-center justify-between","px-4 py-3.5","bg-white border border-gray-200 rounded-xl","text-gray-900 font-semibold","shadow-sm hover:border-blue-400 hover:shadow-md","focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500","transition-all duration-200")},e.createElement("div",{className:"flex items-center gap-3"},e.createElement("div",{className:_("p-2 rounded-lg",b==="jurnal"?"bg-blue-50 text-blue-600":"bg-purple-50 text-purple-600")},e.createElement(f,{className:"w-5 h-5"})),e.createElement("span",null,i.label)),e.createElement(B,{className:_("w-5 h-5 text-gray-400 transition-transform duration-200",s&&"rotate-180")})),e.createElement(P,null,s&&e.createElement(e.Fragment,null,e.createElement("div",{className:"fixed inset-0 z-30",onClick:()=>t(!1)}),e.createElement(y.div,{initial:{opacity:0,y:8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:8,scale:.95},transition:{duration:.2},className:"absolute z-40 w-full mt-2 bg-white border border-gray-100 rounded-xl shadow-xl overflow-hidden"},e.createElement("div",{className:"p-1.5 space-y-1"},l.map(m=>{const p=m.icon,u=b===m.value;return e.createElement("button",{key:m.value,onClick:()=>{n(m.value),t(!1)},className:_("w-full flex items-center justify-between","px-3 py-2.5 rounded-lg","text-sm font-medium transition-colors",u?"bg-blue-50 text-blue-700":"text-gray-600 hover:bg-gray-50 hover:text-gray-900")},e.createElement("div",{className:"flex items-center gap-3"},e.createElement(p,{className:_("w-4 h-4",u?"text-blue-600":"text-gray-400")}),m.label),u&&e.createElement(O,{className:"w-4 h-4 text-blue-600"}))}))))))}function fe({onAddChild:b}){return e.createElement(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},className:"flex flex-col items-center justify-center py-16 px-4"},e.createElement(y.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"w-24 h-24 bg-gradient-to-br from-blue-100 to-purple-100 rounded-full flex items-center justify-center mb-6 shadow-lg"},e.createElement(z,{className:"w-12 h-12 text-blue-600"})),e.createElement("h3",{className:"text-2xl font-bold text-gray-800 mb-3 text-center"},"Belum Ada Data Anak"),e.createElement("p",{className:"text-gray-600 text-center max-w-md mb-8 leading-relaxed"},"Untuk mulai mencatat jurnal makan dan memantau PMT, silakan tambahkan data anak terlebih dahulu."),b&&e.createElement(y.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:b,className:"inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transition-all"},e.createElement(ce,{className:"w-5 h-5"}),"Tambah Data Anak"),e.createElement("div",{className:"mt-8 p-4 bg-blue-50 rounded-lg border border-blue-100 max-w-md"},e.createElement("p",{className:"text-sm text-blue-800 text-center"},"ðŸ’¡ ",e.createElement("span",{className:"font-semibold"},"Tips:")," Anda dapat menambahkan data anak melalui menu Profil atau Dashboard")))}function he({meals:b,loading:n,onDelete:s}){return n?e.createElement("div",{className:"w-full p-8 text-center text-gray-500"},"Memuat data..."):!b||b.length===0?null:e.createElement("div",{className:"w-full mt-0"},e.createElement("div",{className:"hidden md:block bg-white border-t border-gray-200"},e.createElement("div",{className:"overflow-x-auto"},e.createElement("table",{className:"w-full text-left border-collapse"},e.createElement("thead",null,e.createElement("tr",{className:"bg-gray-50 border-b border-gray-200"},e.createElement("th",{className:"py-4 px-6 text-xs font-semibold text-gray-500 uppercase tracking-wider w-[15%]"},e.createElement("div",{className:"flex items-center gap-2"},e.createElement(Z,{className:"w-4 h-4"}),"Waktu")),e.createElement("th",{className:"py-4 px-6 text-xs font-semibold text-gray-500 uppercase tracking-wider w-[25%]"},e.createElement("div",{className:"flex items-center gap-2"},e.createElement(I,{className:"w-4 h-4"}),"Menu")),e.createElement("th",{className:"py-4 px-6 text-xs font-semibold text-gray-500 uppercase tracking-wider w-[15%]"},"Porsi"),e.createElement("th",{className:"py-4 px-6 text-xs font-semibold text-gray-500 uppercase tracking-wider w-[25%]"},e.createElement("div",{className:"flex items-center gap-2"},e.createElement(H,{className:"w-4 h-4"}),"Catatan / Bahan")),e.createElement("th",{className:"py-4 px-6 text-xs font-semibold text-gray-500 uppercase tracking-wider w-[10%] text-right"},"Aksi"))),e.createElement("tbody",{className:"divide-y divide-gray-100"},b.map((t,l)=>e.createElement(y.tr,{key:t.id,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:l*.05},className:"hover:bg-blue-50/50 transition-colors group"},e.createElement("td",{className:"py-4 px-6 align-top"},e.createElement("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},t.time_of_day),e.createElement("div",{className:"text-xs text-gray-400 mt-1 font-mono"},new Date(t.created_at).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}))),e.createElement("td",{className:"py-4 px-6 align-top"},e.createElement("div",{className:"font-medium text-gray-900"},t.description)),e.createElement("td",{className:"py-4 px-6 align-top"},e.createElement("div",{className:"text-sm text-gray-600"},t.portion)),e.createElement("td",{className:"py-4 px-6 align-top"},e.createElement("div",{className:"space-y-1"},t.ingredients&&e.createElement("div",{className:"text-xs text-gray-500"},e.createElement("span",{className:"font-semibold"},"Bahan:")," ",t.ingredients),t.notes&&e.createElement("div",{className:"text-xs text-gray-500 italic"},'"',t.notes,'"'))),e.createElement("td",{className:"py-4 px-6 align-top text-right"},e.createElement("button",{onClick:()=>s(t.id),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Hapus Catatan"},e.createElement(J,{className:"w-4 h-4"}))))))))),e.createElement("div",{className:"block md:hidden space-y-4 px-4 pb-24"},b.map((t,l)=>e.createElement(y.div,{key:t.id,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:l*.05},className:"bg-white p-4 rounded-xl border border-gray-100 shadow-sm"},e.createElement("div",{className:"flex justify-between items-start mb-3"},e.createElement("div",{className:"flex items-center gap-2"},e.createElement("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 capitalize"},t.time_of_day),e.createElement("span",{className:"text-xs text-gray-400 font-mono"},new Date(t.created_at).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}))),e.createElement("button",{onClick:()=>s(t.id),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all"},e.createElement(J,{className:"w-4 h-4"}))),e.createElement("div",{className:"mb-3"},e.createElement("h4",{className:"font-semibold text-gray-900 text-lg"},t.description),t.portion&&e.createElement("div",{className:"inline-block mt-1 px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-md font-medium capitalize"},"Porsi: ",t.portion.replace("_"," "))),(t.ingredients||t.notes)&&e.createElement("div",{className:"space-y-2 pt-3 border-t border-gray-50"},t.ingredients&&e.createElement("div",{className:"flex gap-2 text-sm"},e.createElement(I,{className:"w-4 h-4 text-gray-400 shrink-0 mt-0.5"}),e.createElement("span",{className:"text-gray-600"},t.ingredients)),t.notes&&e.createElement("div",{className:"flex gap-2 text-sm"},e.createElement(H,{className:"w-4 h-4 text-gray-400 shrink-0 mt-0.5"}),e.createElement("span",{className:"text-gray-500 italic"},'"',t.notes,'"')))))))}function Ee(){const b=te(),[n,s]=r.useState("jurnal"),[t,l]=r.useState([]),[i,f]=r.useState(""),[m,p]=r.useState(!0),[u,D]=r.useState([]),[h,S]=r.useState(!1),[v,j]=r.useState(0),[$,w]=r.useState(!1),C=b.state?.prefilledMeal||null;r.useEffect(()=>{c()},[]),r.useEffect(()=>{i&&n==="jurnal"&&g()},[i,n]);const c=async()=>{try{const N=(await T.get("/parent/children")).data.data||[];if(l(N),N.length>0)if(C?.childId){const k=N.find(M=>M.id===C.childId);f(k?k.id:N[0].id)}else f(N[0].id)}catch(x){console.error("Error fetching children:",x)}finally{p(!1)}},g=r.useCallback(async()=>{if(i){S(!0);try{const x=new Date().toISOString().split("T")[0],M=((await T.get(`/meal-logs/child/${i}`)).data.data||[]).filter(A=>new Date(A.eaten_at).toISOString().split("T")[0]===x);D(M)}catch(x){console.error("Error fetching meals:",x)}finally{S(!1)}}},[i]),a=r.useCallback(()=>{g()},[g]),o=r.useCallback(async x=>{if(confirm("Yakin ingin menghapus data ini?"))try{await T.delete(`/meal-logs/${x}`),g()}catch(N){console.error("Error deleting meal:",N),alert("Gagal menghapus data. Silakan coba lagi.")}},[g]),E=t.find(x=>x.id===parseInt(i));return m?e.createElement("div",{className:"flex flex-col h-full w-full bg-gray-50/50 font-sans"},e.createElement("div",{className:"relative z-50"},e.createElement(W,{title:"Jurnal Makan",subtitle:"Portal Orang Tua"})),e.createElement("div",{className:"flex-1 overflow-auto p-6 md:p-10"},e.createElement("div",{className:"max-w-6xl mx-auto animate-pulse space-y-8"},e.createElement("div",{className:"h-8 w-48 bg-gray-200 rounded"}),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-10"},e.createElement("div",{className:"space-y-4"},e.createElement("div",{className:"h-12 w-full bg-gray-200 rounded"}),e.createElement("div",{className:"h-64 w-full bg-gray-200 rounded"})),e.createElement("div",{className:"lg:col-span-2 space-y-4"},e.createElement("div",{className:"h-32 w-full bg-gray-200 rounded"}),e.createElement("div",{className:"h-64 w-full bg-gray-200 rounded"})))))):e.createElement("div",{className:"flex flex-col h-full w-full bg-gray-50/50 font-sans text-gray-900"},e.createElement(y.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},className:"relative z-50"},e.createElement(W,{title:"Jurnal Makan",subtitle:"Portal Orang Tua"})),e.createElement("div",{className:"flex-1 w-full overflow-y-auto custom-scrollbar no-scrollbar md:scrollbar-auto"},e.createElement("div",{className:"p-4 md:p-8"},t.length===0?e.createElement("div",{className:"max-w-6xl mx-auto mt-8"},e.createElement(fe,null)):e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-4 lg:gap-10"},e.createElement("div",{className:"lg:col-span-4 space-y-4 lg:space-y-6"},e.createElement("div",{className:"mb-2"},e.createElement("p",{className:"text-gray-500 mt-1 text-lg"},"Pantau asupan nutrisi ",E?.full_name?.split(" ")[0]||"anak",".")),e.createElement("div",{className:"pt-4 space-y-4 lg:space-y-6"},e.createElement(be,{children:t,selectedChildId:i,onChange:f,loading:m}),e.createElement(ye,{activeTab:n,onTabChange:s})),e.createElement("div",{className:"bg-white rounded-2xl p-6 border border-gray-100 shadow-sm"},e.createElement("h3",{className:"font-semibold text-gray-900 mb-4"},"Ringkasan Hari Ini"),e.createElement("div",{className:"space-y-4"},e.createElement("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-xl"},e.createElement("span",{className:"text-gray-600 text-sm"},"Total Makan"),e.createElement("span",{className:"font-bold text-gray-900"},u.length,"x")),e.createElement("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-xl"},e.createElement("span",{className:"text-gray-600 text-sm"},"Terakhir"),e.createElement("span",{className:"font-bold text-gray-900"},u.length>0?new Date(u[0].created_at).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}):"-"))))),e.createElement("div",{className:"lg:col-span-8"},e.createElement(y.div,{key:n,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:"space-y-8 mt-4 lg:mt-0"},n==="jurnal"?e.createElement(e.Fragment,null,e.createElement("div",{className:"hidden lg:block"},e.createElement(K,{childId:i,onSuccess:a,initialData:C})),e.createElement("div",{className:"pt-4"},u.length===0&&!h&&e.createElement(ie,null))):e.createElement("div",{className:"space-y-8"},e.createElement(me,{childId:i,childName:E?.full_name||"Anak",onSuccess:()=>j(x=>x+1)}),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement(pe,{key:`stats-${v}`,childId:i}),e.createElement(ue,{key:`calendar-${v}`,childId:i}))))))),n==="jurnal"&&u.length>0&&e.createElement(he,{meals:u,loading:h,onDelete:o}),n==="jurnal"&&e.createElement(e.Fragment,null,e.createElement(y.button,{initial:{scale:0},animate:{scale:1},onClick:()=>w(!0),className:"fixed bottom-24 right-6 lg:hidden z-40 w-14 h-14 bg-blue-600 text-white rounded-full shadow-lg shadow-blue-600/30 flex items-center justify-center hover:bg-blue-700 active:scale-95 transition-all"},e.createElement(L,{className:"w-6 h-6"})),e.createElement(P,null,$&&e.createElement(e.Fragment,null,e.createElement("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm lg:hidden",onClick:()=>w(!1)}),e.createElement(y.div,{initial:{opacity:0,y:"100%"},animate:{opacity:1,y:0},exit:{opacity:0,y:"100%"},transition:{type:"spring",damping:25,stiffness:300},className:"fixed inset-x-0 bottom-0 z-50 bg-white rounded-t-3xl p-6 lg:hidden max-h-[90vh] overflow-y-auto"},e.createElement("div",{className:"w-12 h-1.5 bg-gray-200 rounded-full mx-auto mb-6"}),e.createElement(K,{childId:i,onSuccess:()=>{a(),w(!1)},initialData:C})))))))}function ke(){return e.createElement(ee,null,e.createElement(Ee,null))}export{ke as default};
